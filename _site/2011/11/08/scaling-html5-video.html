<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Scaling HTML5 Video</title>
	<meta name="description" content="I enjoy programming stuff - up to and including things!">
	<meta name="author" content="Brian Scaturro">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href='http://fonts.googleapis.com/css?family=Anton' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="/css/base.css">
	<link rel="stylesheet" href="/css/skeleton.css">
	<link rel="stylesheet" href="/css/layout.css">
	<link rel="stylesheet" href="/css/pygments.css">
	<link rel="shortcut icon" href="/images/favicon.ico">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>	
<body>
	<div class="container">
		<div class="eleven columns alpha">
			<header id="branding">
				<a href="/">
					<div class="site-heading">Brian Scaturro</div>
					<div class="site-subheading">Fancy a dance?</div>
				</a>
			</header>
			<div id="main" role="main">
				<article class="eleven columns alpha">
					<h1>Scaling HTML5 Video<span class="post-date">08 Nov 2011</span></h1>
					While working on a project, I had a need ( probably more of a desire ) to scale the HTML5 video I was working with. How this is done is not so apparent, at least it wasn't for me. Sizing the video via its width and height attributes can prove difficult, because that sucker will want to keep its aspect ratio. It is so easy to forget that the video element is just that - that is an element in the DOM. It has a style property like any other element, and that style property can be manipulated. Via the power of CSS3 transforms, you can scale your HTML5 video up and down to your hearts desire. Be sure to check out the demo ( HTML5 video and CSS3 transform support required ).
<div class="tags Yellow">
<a target="_blank" class="add-bottom" href="http://www.brianscaturro.com/demos/video-scale/" title="HTML5 video scaling test">View Demo</a>
</div>
<hr />
<h3>The Problem</h3>
We are going to use the classic Big Buck Bunny trailers as our starting point. Here is what we get by default:
[caption id="attachment_983" align="alignnone" width="620" caption="Default width,height, and aspect ratio"]<a href="http://www.brianscaturro.com/wp-content/uploads/2011/11/default.jpg"><img src="http://www.brianscaturro.com/wp-content/uploads/2011/11/default.jpg" alt="Default width,height, and aspect ratio" title="Default width,height, and aspect ratio" width="620" height="349" class="size-full wp-image-983" /></a>[/caption]

A first thought would be to use the width and height attributes to modify the size, but the video will maintain its aspect ratio if we do things this way. Here is what we get if we modify the height attribute only:

[caption id="attachment_986" align="alignnone" width="355" caption="Height attribute changed"]<a href="http://www.brianscaturro.com/wp-content/uploads/2011/11/heightattr.jpg"><img src="http://www.brianscaturro.com/wp-content/uploads/2011/11/heightattr.jpg" alt="Height attribute changed" title="Height attribute changed" width="355" height="200" class="size-full wp-image-986" /></a>[/caption]

Re-sizing is very limited with the height and width attributes. We need something else.

<h3>Scaling video with CSS3 transforms</h3>

We want to be able to scale up or down, and we want to be able to define our own dimensions and aspect ratio. This can be done with CSS3 transforms. We are going to use a little JavaScript function to do this, but it could also be accomplished with some declarations in a style sheet. Specifically, we are are going to be dealing with the scaleY and scaleX functions of CSS3 transform.

The solution is pretty simple. We can easily achieve the desired affect with the following formulas:
<code>
xScale = targetWidth/videoWidth
yScale = targetHeight/videoHeight
</code>

Armed with this knowledge of overly complex mathematics, we can wrap this into a handy little JavaScript function to solve all of our woes:
<pre class="prettyprint">
function resizeVideo(vidId,width,height) {
	//check for the standard transform first, then look for vendor specific
	var vendorTransforms = ['transform', 'WebkitTransform', 'MozTransform','msTransform', 'OTransform'],
		video = document.getElementById(vidId),
		vWidth = video.width,
		vHeight = video.height,
		xScale = width/vWidth,
		yScale = height/vHeight,
		prop = undefined;
		
	for ( var i=0; i < vendorTransforms.length; i++ ) {
		if ( typeof video.style[vendorTransforms[i]] !== 'undefined' ) {
			prop = vendorTransforms[i];
		}
	};
	
	if ( prop ) {
		video.style[prop] = 'scaleX(' + xScale + ') scaleY(' + yScale + ')';
	}
}
</pre>

The idea here is to check for support of the CSS3 transform property. We first check for support of the W3C standard transform property, and if it isn't supported, then we work our way down the list of vendor specific transform properties. If one is found, then we apply the scaleY and scaleX functions of the transform property. Once the document has loaded, it is easy to change our video size:
<pre class="prettyprint">
resizeVideo('vid3',500,500);
</pre>

This gives us:
[caption id="attachment_993" align="alignnone" width="502" caption="500 by 500 video"]<a href="http://www.brianscaturro.com/wp-content/uploads/2011/11/Screenshot_2.jpg"><img src="http://www.brianscaturro.com/wp-content/uploads/2011/11/Screenshot_2.jpg" alt="500 by 500 video" title="500 by 500 video" width="502" height="499" class="size-full wp-image-993" /></a>[/caption]

<h3>Conclusion</h3>
This may not be the ideal solution. It is a rather clunky way of scaling video. It also requires there to be a width and height attribute present on the video - it is a good practice to include these and it should be done, but what if these attributes are omitted? One potential solution is to use the loadedmetadata event of the video element and try to get the videoHeight and videoWidth properties:
<pre class="prettyprint lang=js">
video.addEventListener('loadedmetadata',function(){
    var height = this.videoHeight,
        width = this.videoWidth;
    //resize code
});
</pre>

This is a slightly shaky subject, and I would love to find out more from others who have encountered this problem and solved it.

				</article>
			</div>
		</div>
		<aside class="four columns omega offset-by-one" id="sidebar">
			<img class="aligncenter add-bottom photo" src="/images/steed.jpg" alt="some of my best thinking occurs on unicorns">
			<h2 class="sub-heading">Recent Posts</h2>
			<ul class='posts'>
				
				<li><h3><a href="/2012/05/21/domain-driven-php.html">Domain Driven PHP</a></h3></li>
				
				<li><h3><a href="/2012/04/27/is-agile-dead.html">Is Agile Dead?</a></h3></li>
				
				<li><h3><a href="/2012/03/27/tdd-with-mock-objects-and-phpunit.html">TDD With Mock Objects And PHPUnit</a></h3></li>
				
				<li><h3><a href="/2012/03/10/javascript-masterclass-review.html">JavaScript Masterclass With Thomas Fuchs and Amy Hoy: A Review</a></h3></li>
				
				<li><h3><a href="/">The rest....</a></h3></li>
			</ul>
		</aside>
	</div>
</body>
</html>